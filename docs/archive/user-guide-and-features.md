# 時間表系統功能說明與使用指南

## 🎯 系統概述

本時間表系統是一個基於網頁的工時管理工具，支援多週工時表管理、自動資料驗證、CSV 資料整合等功能。系統設計為單人使用，所有資料儲存在瀏覽器本地。

## ✨ 主要功能特色

### 1. 全域基本資料管理
- **一次設定，全域共用**：員工姓名和內部/外包類型只需設定一次
- **多重設定入口**：可在首頁或編輯頁面設定基本資料
- **即時生效**：修改基本資料立即套用到所有工時記錄

### 2. 智慧型 CSV 資料整合
- **自動載入專案資料**：從 `projectcode.csv` 載入專案與 PM 對應關係
- **產品模組對應**：從 `productcode.csv` 載入產品模組清單
- **活動類型管理**：從 `activityType.csv` 載入所有活動類型

### 3. Zone 聯動選擇機制
- **智慧篩選**：選擇區域後自動篩選對應的專案和產品模組
- **PM 聯動邏輯**：PM 欄位根據 Zone + Project 組合自動填充
- **自動清空**：變更 Zone 時自動清空 PM 欄位，確保資料一致性
- **重要提醒**：PM 查找必須同時考慮 Zone 和 Project，因為不同 Zone 可能有同名專案

### 4. 多週工時表管理
- **卡片化展示**：以視覺化卡片顯示各週工時表
- **快速統計**：顯示每週總工時和記錄筆數
- **狀態指示**：視覺化顯示工時表完成狀態

### 5. CSV 導入/導出功能
- **CSV 導出**：支援 UTF-8 編碼，正規化模式（週總工時 > 40 小時時調整）
- **CSV 導入**：自動按週次分組，支援基本資訊衝突處理
- **資料驗證**：導入時自動驗證欄位格式和必填項目
- **衝突處理**：
  - 一致資料：確認對話框（繼續匯入/取消匯入）
  - 衝突資料：選擇對話框（使用本地資料/使用CSV資料）

### 6. TPM 驗證工具
- **獨立儀表板**：`tpm-validator.html` 提供專門的驗證功能
- **多重驗證規則**：
  - Admin/Training 活動驗證
  - 8小時正常工時驗證
  - 週總工時範圍驗證
- **批次處理**：支援多個 CSV 檔案同時驗證
- **詳細報告**：提供完整的驗證結果報告

## 📱 使用指南

### 首次使用設定

#### 1. 設定基本資料
1. 開啟系統首頁
2. 點擊「基本資料設定」按鈕
3. 填寫員工姓名和選擇內部/外包類型
4. 點擊「儲存」完成設定

#### 2. 建立第一個工時表
1. 點擊「新建」按鈕
2. 輸入週次格式（例如：2023-W25）
3. 系統自動跳轉到編輯頁面

### 工時記錄填寫流程

#### 1. 基本操作
1. **選擇區域（Zone）**
   - Customer Portal
   - ERP
   - OA  
   - Admin

2. **選擇專案**
   - 系統自動載入該區域的所有專案
   - 顯示格式：「專案名稱 (專案代碼)」
   - 選擇後自動填入專案經理

3. **選擇產品模組**
   - 系統自動載入該區域的所有產品模組
   - 從下拉選單中選擇適當的模組

4. **填寫任務資訊**
   - 任務描述（必填）
   - 活動類型（必填）：
     - UI/UX Design
     - Architecture Planning
     - System Design
     - Coding
     - Testing / QA
     - Deployment / Monitoring
     - Troubleshooting
     - Requirement Analysis
     - Admin / Training
     - Leave

5. **填寫工時資訊**
   - 正常工時（必填）
   - 加班工時（選填）
   - 總工時（自動計算）
   - 工作日期（必填）
   - 開始/結束日期（選填）

6. **備註資訊**
   - 工作備註（選填）

#### 2. 儲存與管理
1. 點擊「儲存記錄」完成單筆記錄
2. 可繼續新增多筆記錄
3. 在記錄列表中可以編輯或刪除已有記錄

### 工時表管理功能

#### 1. 查看工時表列表
- **卡片顯示**：每週工時表以卡片形式展示
- **快速資訊**：
  - 週次標題（YYYY-Www）
  - 日期範圍（週日至週六）
  - 記錄筆數統計
  - 總工時統計
- **狀態指示**：
  - ✓ 綠色：總工時達 40 小時
  - ⚠ 橙色：總工時未達 40 小時

#### 2. 工時表操作
- **修改**：進入編輯頁面修改工時記錄
- **刪除**：刪除整週工時表（需確認）
- **複製**：複製現有週次工時表到新週次
- **匯出**：導出工時表為 CSV 格式（UTF-8 編碼）
- **匯入**：從 CSV 檔案匯入工時記錄

#### 3. 快速建立功能
- **上週工時表**：一鍵建立上週工時表
- **自動計算日期**：系統自動計算上週的日期範圍

## 🔧 進階功能

### 1. 響應式設計
- **桌面版**：完整功能展示，多欄佈局
- **平板版**：適中的卡片佈局
- **手機版**：垂直單欄佈局，觸控友善

### 2. 資料驗證
- **必填欄位檢查**：確保重要資訊完整
- **格式驗證**：工時範圍、日期邏輯檢查
- **即時提示**：錯誤訊息即時顯示

### 3. 自動化功能
- **工時計算**：正常工時 + 加班工時 = 總工時
- **日期管理**：週日到週六的標準週範圍
- **資料同步**：基本資料變更自動同步到所有記錄

## 📊 資料格式說明

### CSV 檔案格式

#### projectcode.csv
```csv
Project,Zone,Charge Code,PM,Content,Zone Helper
Shipment Module Redesign,Customer Portal,2025-CP001,Evelyn,,Customer Portal
Booking Redesign,Customer Portal,2025-CP002,Evelyn,Template & Column Layout Adjustment,ERP
```

#### productcode.csv
```csv
Module,Product,Zone,Product Module
Dashboard,Customer Portal,Customer Portal,Customer Portal Dashboard
Bookings,Customer Portal,Customer Portal,Customer Portal Bookings
```

#### activityType.csv
```csv
Activity Type
UI/UX Design
Architecture Planning
System Design
Coding
```

### 工時記錄格式
每筆工時記錄包含以下欄位：
- **基本資訊**：員工姓名、內部/外包類型（來自全域設定）
- **專案資訊**：區域、專案、產品模組、活動類型、專案經理
- **任務資訊**：任務描述、備註
- **時間資訊**：正常工時、加班工時、總工時、日期範圍

## 🚀 使用技巧

### 1. 效率提升
- **基本資料**：首次設定後無需重複填寫
- **Zone 選擇**：優先選擇 Zone，自動載入相關選項
- **複製記錄**：可編輯已有記錄快速建立類似工時

### 2. 資料管理
- **定期檢查**：確認每週工時是否達到標準
- **備份資料**：定期導出重要工時記錄
- **清理資料**：刪除不需要的測試記錄

### 3. 錯誤避免
- **確認基本資料**：開始填寫前確認基本資料正確
- **檢查日期**：確認工作日期在正確的週範圍內
- **驗證工時**：確認工時數字合理（0-24小時）

## 🔍 故障排除

### 常見問題

#### 1. 專案選項沒有出現
**原因**：CSV 檔案載入失敗或 Zone 選擇問題
**解決**：
1. 確認網路連線正常
2. 重新整理頁面
3. 檢查瀏覽器 console 是否有錯誤訊息

#### 2. 基本資料沒有儲存
**原因**：瀏覽器 localStorage 限制
**解決**：
1. 清理瀏覽器快取
2. 確認瀏覽器允許 localStorage
3. 嘗試使用無痕模式

#### 3. 工時計算錯誤
**原因**：輸入格式問題
**解決**：
1. 確認工時使用數字格式
2. 檢查是否有非法字元
3. 重新輸入工時數據

#### 4. 頁面顯示異常
**原因**：瀏覽器相容性問題
**解決**：
1. 使用 Chrome、Firefox、Safari 等現代瀏覽器
2. 確認 JavaScript 已啟用
3. 清除瀏覽器快取後重新載入

### 瀏覽器支援
- **推薦**：Chrome 70+、Firefox 65+、Safari 12+、Edge 79+
- **功能需求**：支援 ES6、localStorage、Fetch API

## 📈 系統限制

### 技術限制
- **本地儲存**：資料僅存於瀏覽器，清除資料會遺失記錄
- **單人使用**：不支援多人協作或資料同步
- **檔案大小**：CSV 檔案建議小於 1MB

### 功能限制
- **導出格式**：目前僅支援 CSV 格式導出
- **本地儲存**：無雲端同步功能
- **權限管理**：無使用者權限區分
- **批次操作**：無批次編輯功能

## 🛣️ 未來發展

### ✅ 已完成功能（100%）
1. **CSV 導入/導出**：完整的 CSV 格式支援，包含衝突處理
2. **TPM 驗證工具**：獨立的驗證儀表板
3. **Zone 聯動機制**：完整的自動填充系統
4. **多週工時表管理**：卡片式列表和完整 CRUD 操作
5. **表單驗證系統**：即時驗證和錯誤處理
6. **響應式設計**：適配各種裝置

### 🔄 持續改進方向
1. **雲端同步**：資料備份與多裝置同步
2. **批次操作**：多選和批次編輯功能
3. **進階報表**：月度、季度統計分析
4. **使用者體驗**：更直觀的操作介面


---

*本文件提供時間表系統的完整使用說明，如有問題請參考故障排除章節*